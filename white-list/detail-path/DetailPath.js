export default {
  name: 'DetailPath',
  data() {
    return {
      activeName: 'first',
      nodeList: []
    }
  },
  mounted() {
    this.init()
  },
  methods: {
    // 初始化组件
    init() {
      this.parseNodeList()
    },
    // 整理线路数据
    parseNodeList() {
      const jsonString = '[{"deviceUuid":"001b9a43bb8740aeab6c5589b8216012","inIfId":"55a212c4e79e41fb94eea26e88e1e0b2","outIfId":"5031aa3f68ad429bb94e995db9162174","currDevicePathStatus":"FULLY_OPEN","deviceFlows":[{"flowList":[{"traffic":[{"protocols":[{"start":1,"end":1}],"ip4SrcAddresses":[{"start":"30.1.1.0","end":"30.1.1.255"}],"ip4DstAddresses":[{"start":"9.1.2.0","end":"9.1.2.255"}]}]}]}],"pathStatus":"FULLY_OPEN","device":{"id":13,"ip":"10.12.32.39","uuid":"001b9a43bb8740aeab6c5589b8216012","type":"0","deviceName":"PartA-FW","deviceTemplateId":"cisco-asa","createdTime":"2020-09-25T15:00:00.000+0800","modifiedTime":"2020-09-25T15:01:43.000+0800","credentialUuid":"dd4e65c818324d498b2076d84b5cd6a4","gatherId":"5ef05da446634b3598b477f4","taskType":"GENERIC","taskUuid":"ad4f2ccd3b124ff1b58178aa213788ff","deviceLogUuid":"072196de43e3492dbe76e46a65b2c771","controllerId":"cisco-asa-telnet","portNumber":23,"timeout":180,"customPythonPath":"","gatherType":0,"gatherCycle":"1","vendorName":"思科","vendorId":"cisco","version":4,"pluginId":"cisco-asa","logDetailId":"","origin":2,"state":1,"filePath":"/home/topology/attachment/history/cisco-asa_10.12.32.39_d8b024f2a7b044c4a1d486cfe51092c3__PartA-FW.zee","nodeGroup":-1,"modelNumber":"Cisco ASA","description":"PartA-FW","includeRouting":true},"inInterface":{"name":"Ethernet2","uuid":"55a212c4e79e41fb94eea26e88e1e0b2","lineNumbers":"[21-24]","type":"REG","ipType":"IP4","deviceInterfaceName":"Ethernet2","ip4Address":"30.1.1.1","ip4MaskLength":"24","ip4SubnetUuid":"02852f42550646a1b6aef2c7105f74b7","inboundRuleListRefs":"[\\"in2out\\"]","linkedDevice":false,"ip4SubnetAddress":"30.1.1.0"},"outInterface":{"name":"Ethernet1","uuid":"5031aa3f68ad429bb94e995db9162174","lineNumbers":"[16-19]","type":"REG","ipType":"IP4","deviceInterfaceName":"Ethernet1","ip4Address":"9.3.2.2","ip4MaskLength":"30","ip4SubnetUuid":"f11d31e6c9ca4c54956fda1cbcd2d675","inboundRuleListRefs":"[\\"out2in\\"]","linkedDevice":true,"devices":[{"id":"5ef05b5646634b3598b477b4","lastModifiedTime":"2020-08-04T12:01:07.335+0800","uuid":"ad5940dde1bb40be94e244ff5114cc42","name":"Core-SW","deviceType":"ROUTER","manufacturer":"Cisco Systems, Inc.","collectType":"CONFIG_INBOX","deviceAlias":"Core-SW","primaryId":"10.12.32.38","isVsys":"false","interfaces":[{"name":"GigabitEthernet0/1","uuid":"d03271d146a44bc9a16cf2d448602cca","lineNumbers":"[66-69]","type":"REG","ipType":"IP4","deviceInterfaceName":"GigabitEthernet0/1","ip4Address":"9.3.2.1","ip4MaskLength":"30","ip4SubnetUuid":"f11d31e6c9ca4c54956fda1cbcd2d675"}]}],"ip4SubnetAddress":"9.3.2.0"}},{"deviceUuid":"ad5940dde1bb40be94e244ff5114cc42","inIfId":"d03271d146a44bc9a16cf2d448602cca","outIfId":"d11966a744ee4ff4ac8e8e755c79850e","currDevicePathStatus":"FULLY_OPEN","deviceFlows":[{"flowList":[{"traffic":[{"protocols":[{"start":1,"end":1}],"ip4SrcAddresses":[{"start":"30.1.1.0","end":"30.1.1.255"}],"ip4DstAddresses":[{"start":"9.1.2.0","end":"9.1.2.255"}]}]}]}],"pathStatus":"FULLY_OPEN","device":{"id":11,"ip":"10.12.32.38","uuid":"ad5940dde1bb40be94e244ff5114cc42","type":"1","deviceName":"Core-SW","deviceTemplateId":"cisco-ios","createdTime":"2020-09-25T15:00:00.000+0800","modifiedTime":"2020-09-25T15:01:42.000+0800","credentialUuid":"dd4e65c818324d498b2076d84b5cd6a4","gatherId":"5ef05b3846634b3598b477a8","taskType":"GENERIC","taskUuid":"462e21ff3d6c48f18796f853283bfd7c","deviceLogUuid":"2485684cecf5473bb85a5cfad5115a93","controllerId":"cisco-ios-telnet","portNumber":23,"timeout":180,"customPythonPath":"","gatherType":0,"gatherCycle":"1","vendorName":"思科","vendorId":"cisco","version":2,"pluginId":"cisco-ios","logDetailId":"","origin":2,"state":1,"filePath":"/home/topology/attachment/history/cisco-ios_10.12.32.38_cbad708a678c443ab8e1bac94338d422__Core-SW.zee","nodeGroup":-1,"modelNumber":"Cisco IOS","description":"Core-SW","includeRouting":true},"inInterface":{"name":"GigabitEthernet0/1","uuid":"d03271d146a44bc9a16cf2d448602cca","lineNumbers":"[66-69]","type":"REG","ipType":"IP4","deviceInterfaceName":"GigabitEthernet0/1","ip4Address":"9.3.2.1","ip4MaskLength":"30","ip4SubnetUuid":"f11d31e6c9ca4c54956fda1cbcd2d675","linkedDevice":true,"devices":[{"id":"5ef05bc546634b3598b477dc","lastModifiedTime":"2020-09-25T14:01:44.848+0800","uuid":"001b9a43bb8740aeab6c5589b8216012","name":"PartA-FW","deviceType":"FIREWALL","manufacturer":"Cisco Systems, Inc.","collectType":"CONFIG_INBOX","deviceAlias":"PartA-FW","primaryId":"10.12.32.39","isVsys":"false","interfaces":[{"name":"Ethernet1","uuid":"5031aa3f68ad429bb94e995db9162174","lineNumbers":"[16-19]","type":"REG","ipType":"IP4","deviceInterfaceName":"Ethernet1","ip4Address":"9.3.2.2","ip4MaskLength":"30","ip4SubnetUuid":"f11d31e6c9ca4c54956fda1cbcd2d675","inboundRuleListRefs":"[\\"out2in\\"]"}]}],"ip4SubnetAddress":"9.3.2.0"},"outInterface":{"name":"GigabitEthernet0/0","uuid":"d11966a744ee4ff4ac8e8e755c79850e","lineNumbers":"[61-64]","type":"REG","ipType":"IP4","deviceInterfaceName":"GigabitEthernet0/0","ip4Address":"9.3.1.2","ip4MaskLength":"30","ip4SubnetUuid":"b45e88cf9bfa4dcc81b728e3ed0abf6d","linkedDevice":true,"devices":[{"id":"5ef05ab746634b3598b4778d","lastModifiedTime":"2020-09-25T14:01:35.916+0800","uuid":"00df1b23a2114df1b22d8d38a1bd102d","name":"ASA","deviceType":"FIREWALL","manufacturer":"Cisco Systems, Inc.","collectType":"CONFIG_INBOX","deviceAlias":"ASA","primaryId":"10.12.32.37","isVsys":"false","interfaces":[{"name":"Ethernet2","uuid":"3d57c1673c90452eba2563e873347172","lineNumbers":"[21-24]","type":"REG","ipType":"IP4","deviceInterfaceName":"Ethernet2","ip4Address":"9.3.1.1","ip4MaskLength":"30","ip4SubnetUuid":"b45e88cf9bfa4dcc81b728e3ed0abf6d","inboundRuleListRefs":"[\\"in2out\\"]"}]}],"ip4SubnetAddress":"9.3.1.0"}},{"deviceUuid":"00df1b23a2114df1b22d8d38a1bd102d","inIfId":"3d57c1673c90452eba2563e873347172","outIfId":"2c957b9db9474d50a8b05279723af417","currDevicePathStatus":"FULLY_OPEN","deviceFlows":[{"flowList":[{"traffic":[{"protocols":[{"start":1,"end":1}],"ip4SrcAddresses":[{"start":"30.1.1.0","end":"30.1.1.255"}],"ip4DstAddresses":[{"start":"9.1.2.0","end":"9.1.2.255"}]}]}]}],"pathStatus":"FULLY_OPEN","device":{"id":10,"ip":"10.12.32.37","uuid":"00df1b23a2114df1b22d8d38a1bd102d","type":"0","deviceName":"ASA","deviceTemplateId":"cisco-asa","createdTime":"2020-09-25T15:00:00.000+0800","modifiedTime":"2020-09-25T15:01:42.000+0800","credentialUuid":"dd4e65c818324d498b2076d84b5cd6a4","gatherId":"5ef0599246634b3598b4776e","taskType":"GENERIC","taskUuid":"5866637b35f34ee9806f07625193ceae","deviceLogUuid":"1993bfab8ab84fafbd32cc75a1d660a0","controllerId":"cisco-asa-telnet","portNumber":23,"timeout":180,"customPythonPath":"","gatherType":0,"gatherCycle":"1","vendorName":"思科","vendorId":"cisco","version":4,"pluginId":"cisco-asa","logDetailId":"","origin":2,"state":1,"filePath":"/home/topology/attachment/history/cisco-asa_10.12.32.37_988c6b6ad4484966a5eba7d9ea7ea0b5__ASA.zee","nodeGroup":-1,"modelNumber":"Cisco ASA","description":"ASA","includeRouting":true},"inInterface":{"name":"Ethernet2","uuid":"3d57c1673c90452eba2563e873347172","lineNumbers":"[21-24]","type":"REG","ipType":"IP4","deviceInterfaceName":"Ethernet2","ip4Address":"9.3.1.1","ip4MaskLength":"30","ip4SubnetUuid":"b45e88cf9bfa4dcc81b728e3ed0abf6d","inboundRuleListRefs":"[\\"in2out\\"]","linkedDevice":true,"devices":[{"id":"5ef05b5646634b3598b477b4","lastModifiedTime":"2020-08-04T12:01:07.335+0800","uuid":"ad5940dde1bb40be94e244ff5114cc42","name":"Core-SW","deviceType":"ROUTER","manufacturer":"Cisco Systems, Inc.","collectType":"CONFIG_INBOX","deviceAlias":"Core-SW","primaryId":"10.12.32.38","isVsys":"false","interfaces":[{"name":"GigabitEthernet0/0","uuid":"d11966a744ee4ff4ac8e8e755c79850e","lineNumbers":"[61-64]","type":"REG","ipType":"IP4","deviceInterfaceName":"GigabitEthernet0/0","ip4Address":"9.3.1.2","ip4MaskLength":"30","ip4SubnetUuid":"b45e88cf9bfa4dcc81b728e3ed0abf6d"}]}],"ip4SubnetAddress":"9.3.1.0"},"outInterface":{"name":"Ethernet1","uuid":"2c957b9db9474d50a8b05279723af417","lineNumbers":"[16-19]","type":"REG","ipType":"IP4","deviceInterfaceName":"Ethernet1","ip4Address":"9.1.4.2","ip4MaskLength":"30","ip4SubnetUuid":"81d4dce3a1224a56a4e7c94df304de3f","inboundRuleListRefs":"[\\"out2in\\"]","linkedDevice":true,"devices":[{"id":"5ef0574646634b3598b476f9","lastModifiedTime":"2020-09-03T15:00:29.632+0800","uuid":"47f23ca25e3f487bb1d54e8c7d81e015","name":"EXT-AS","deviceType":"ROUTER","manufacturer":"Cisco Systems, Inc.","collectType":"CONFIG_INBOX","deviceAlias":"Ext-AS","primaryId":"10.12.32.34","isVsys":"false","interfaces":[{"name":"GigabitEthernet0/1","uuid":"c3c9bff7d37844968d363964a9cf9d9f","lineNumbers":"[56-59]","type":"REG","ipType":"IP4","deviceInterfaceName":"GigabitEthernet0/1","ip4Address":"9.1.4.1","ip4MaskLength":"30","ip4SubnetUuid":"81d4dce3a1224a56a4e7c94df304de3f"}]}],"ip4SubnetAddress":"9.1.4.0"}},{"deviceUuid":"47f23ca25e3f487bb1d54e8c7d81e015","inIfId":"c3c9bff7d37844968d363964a9cf9d9f","outIfId":"75586dcd9c044451a14dfb12fd8c93e3","currDevicePathStatus":"FULLY_OPEN","deviceFlows":[{"flowList":[{"traffic":[{"protocols":[{"start":1,"end":1}],"ip4SrcAddresses":[{"start":"30.1.1.0","end":"30.1.1.255"}],"ip4DstAddresses":[{"start":"9.1.2.0","end":"9.1.2.255"}]}]}]}],"pathStatus":"FULLY_OPEN","device":{"id":7,"ip":"10.12.32.34","uuid":"47f23ca25e3f487bb1d54e8c7d81e015","type":"1","deviceName":"Ext-AS","deviceTemplateId":"cisco-ios","createdTime":"2020-09-25T15:00:00.000+0800","modifiedTime":"2020-09-25T15:00:42.000+0800","credentialUuid":"dd4e65c818324d498b2076d84b5cd6a4","gatherId":"5ef0572946634b3598b476ed","taskType":"GENERIC","taskUuid":"12068da6ce4e41fbb7d889a681e032c4","deviceLogUuid":"1f9c7a7007424a2eb6970eb91b2aa2e6","controllerId":"cisco-ios-telnet","portNumber":23,"timeout":180,"customPythonPath":"","gatherType":0,"gatherCycle":"1","vendorName":"思科","vendorId":"cisco","version":2,"pluginId":"cisco-ios","logDetailId":"","origin":2,"state":1,"filePath":"/home/topology/attachment/history/cisco-ios_10.12.32.34_785c11cb3b464efc946b4fdc9eba2f92__EXT-AS.zee","nodeGroup":-1,"modelNumber":"Cisco IOS","description":"Ext-AS","includeRouting":true},"inInterface":{"name":"GigabitEthernet0/1","uuid":"c3c9bff7d37844968d363964a9cf9d9f","lineNumbers":"[56-59]","type":"REG","ipType":"IP4","deviceInterfaceName":"GigabitEthernet0/1","ip4Address":"9.1.4.1","ip4MaskLength":"30","ip4SubnetUuid":"81d4dce3a1224a56a4e7c94df304de3f","linkedDevice":true,"devices":[{"id":"5ef05ab746634b3598b4778d","lastModifiedTime":"2020-09-25T14:01:35.916+0800","uuid":"00df1b23a2114df1b22d8d38a1bd102d","name":"ASA","deviceType":"FIREWALL","manufacturer":"Cisco Systems, Inc.","collectType":"CONFIG_INBOX","deviceAlias":"ASA","primaryId":"10.12.32.37","isVsys":"false","interfaces":[{"name":"Ethernet1","uuid":"2c957b9db9474d50a8b05279723af417","lineNumbers":"[16-19]","type":"REG","ipType":"IP4","deviceInterfaceName":"Ethernet1","ip4Address":"9.1.4.2","ip4MaskLength":"30","ip4SubnetUuid":"81d4dce3a1224a56a4e7c94df304de3f","inboundRuleListRefs":"[\\"out2in\\"]"}]}],"ip4SubnetAddress":"9.1.4.0"},"outInterface":{"name":"Vlan100","uuid":"75586dcd9c044451a14dfb12fd8c93e3","lineNumbers":"[94-95]","type":"REG","ipType":"IP4","deviceInterfaceName":"Vlan100","ip4Address":"9.1.2.5","ip4MaskLength":"24","ip4SubnetUuid":"83f6a353a7274da2a0f841565d1c401a","linkedDevice":true,"devices":[{"id":"5ef0532f46634b3598b476d2","lastModifiedTime":"2020-09-25T15:00:26.885+0800","uuid":"514dfbff16744b7bb4d0d2d59d572087","name":"Ext-FW","deviceType":"FIREWALL","manufacturer":"Hillstone","collectType":"CONFIG_INBOX","deviceAlias":"Ext-FW","primaryId":"10.12.32.33","isVsys":"false","interfaces":[{"name":"ethernet0/2","uuid":"c5f2c2aa918d43dab0ae4f82b985531a","description":"internal","lineNumbers":"[714-723]","type":"REG","ipType":"IP4","deviceInterfaceName":"ethernet0/2","ip4Address":"9.1.2.1","ip4MaskLength":"24","ip4SubnetUuid":"83f6a353a7274da2a0f841565d1c401a"}]}],"subnetName":"internal","ip4SubnetAddress":"9.1.2.0"}}]'
      const list = JSON.parse(jsonString)
      const nodeList = []
      list.forEach(dev => {
        const { inInterface, device } = dev
        nodeList.push({
          nodeName: '',
          nodeIp: inInterface.ip4SubnetAddress + '/' + inInterface.ip4MaskLength,
          nodeType: 'subnet',
          nodeId: inInterface.uuid
        })
        nodeList.push({
          nodeName: device.deviceName,
          nodeIp: device.ip,
          nodeType: device.type,
          nodeId: device.uuid
        })
      })
      const outInterface = list[list.length - 1].outInterface
      nodeList.push({
        nodeName: '',
        nodeIp: outInterface.ip4SubnetAddress + '/' + outInterface.ip4MaskLength,
        nodeType: 'subnet',
        nodeId: outInterface.uuid
      })
      this.nodeList = nodeList
    }
  }
}
